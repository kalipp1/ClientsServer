{"ast":null,"code":"import{useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{Button,Progress,Alert}from'reactstrap';import{getSeats,loadSeatsRequest,getRequests}from'../../../redux/seatsRedux';import'./SeatChooser.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SeatChooser=_ref=>{let{chosenDay,chosenSeat,updateSeat,onSeatReserved}=_ref;const dispatch=useDispatch();const seats=useSelector(getSeats);const requests=useSelector(getRequests);useEffect(()=>{dispatch(loadSeatsRequest());const interval=setInterval(()=>{dispatch(loadSeatsRequest());},2*60*1000);return()=>clearInterval(interval);},[dispatch]);useEffect(()=>{if(onSeatReserved){dispatch(loadSeatsRequest());}},[onSeatReserved,dispatch]);const isTaken=seatId=>{return seats.some(item=>item.seat===seatId&&item.day===chosenDay);};const prepareSeat=seatId=>{if(seatId===chosenSeat)return/*#__PURE__*/_jsx(Button,{className:\"seats__seat\",color:\"primary\",children:seatId},seatId);else if(isTaken(seatId))return/*#__PURE__*/_jsx(Button,{className:\"seats__seat\",disabled:true,color:\"secondary\",children:seatId},seatId);else return/*#__PURE__*/_jsx(Button,{color:\"primary\",className:\"seats__seat\",outline:true,onClick:e=>updateSeat(e,seatId),children:seatId},seatId);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Pick a seat\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"small\",{id:\"pickHelp\",className:\"form-text text-muted ms-2\",children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\"}),\" \\u2013 seat is already taken\"]}),/*#__PURE__*/_jsxs(\"small\",{id:\"pickHelpTwo\",className:\"form-text text-muted ms-2\",children:[/*#__PURE__*/_jsx(Button,{outline:true,color:\"primary\"}),\" \\u2013 it's empty\"]})]}),requests['LOAD_SEATS']&&requests['LOAD_SEATS'].success&&/*#__PURE__*/_jsx(\"div\",{className:\"seats\",children:[...Array(50)].map((x,i)=>prepareSeat(i+1))}),requests['LOAD_SEATS']&&requests['LOAD_SEATS'].pending&&/*#__PURE__*/_jsx(Progress,{animated:true,color:\"primary\",value:50}),requests['LOAD_SEATS']&&requests['LOAD_SEATS'].error&&/*#__PURE__*/_jsx(Alert,{color:\"warning\",children:\"Couldn't load seats...\"})]});};export default SeatChooser;","map":{"version":3,"names":["useEffect","useDispatch","useSelector","Button","Progress","Alert","getSeats","loadSeatsRequest","getRequests","jsx","_jsx","jsxs","_jsxs","SeatChooser","_ref","chosenDay","chosenSeat","updateSeat","onSeatReserved","dispatch","seats","requests","interval","setInterval","clearInterval","isTaken","seatId","some","item","seat","day","prepareSeat","className","color","children","disabled","outline","onClick","e","id","success","Array","map","x","i","pending","animated","value","error"],"sources":["/Users/maksymilianbirecki/ClientsServer/client/src/components/features/SeatChooser/SeatChooser.js"],"sourcesContent":["import { useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Button, Progress, Alert } from 'reactstrap';\r\nimport { getSeats, loadSeatsRequest, getRequests } from '../../../redux/seatsRedux';\r\nimport './SeatChooser.scss';\r\n\r\nconst SeatChooser = ({ chosenDay, chosenSeat, updateSeat, onSeatReserved }) => {\r\n  const dispatch = useDispatch();\r\n  const seats = useSelector(getSeats);\r\n  const requests = useSelector(getRequests);\r\n  \r\n  useEffect(() => {\r\n    dispatch(loadSeatsRequest());\r\n\r\n    const interval = setInterval(() => {\r\n      dispatch(loadSeatsRequest())\r\n    }, 2*60*1000);\r\n\r\n    return() => clearInterval(interval);\r\n  }, [dispatch])\r\n\r\n  useEffect(() => {\r\n    if (onSeatReserved) {\r\n      dispatch(loadSeatsRequest());\r\n    }\r\n  }, [onSeatReserved, dispatch]);\r\n\r\n  const isTaken = (seatId) => {\r\n    return (seats.some(item => (item.seat === seatId && item.day === chosenDay)));\r\n  }\r\n\r\n  const prepareSeat = (seatId) => {\r\n    if(seatId === chosenSeat) return <Button key={seatId} className=\"seats__seat\" color=\"primary\">{seatId}</Button>;\r\n    else if(isTaken(seatId)) return <Button key={seatId} className=\"seats__seat\" disabled color=\"secondary\">{seatId}</Button>;\r\n    else return <Button key={seatId} color=\"primary\" className=\"seats__seat\" outline onClick={(e) => updateSeat(e, seatId)}>{seatId}</Button>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Pick a seat</h3>\r\n      <div className=\"mb-4\">\r\n        <small id=\"pickHelp\" className=\"form-text text-muted ms-2\"><Button color=\"secondary\" /> – seat is already taken</small>\r\n        <small id=\"pickHelpTwo\" className=\"form-text text-muted ms-2\"><Button outline color=\"primary\" /> – it's empty</small>\r\n      </div>\r\n      { (requests['LOAD_SEATS'] && requests['LOAD_SEATS'].success) && <div className=\"seats\">{[...Array(50)].map((x, i) => prepareSeat(i+1) )}</div>}\r\n      { (requests['LOAD_SEATS'] && requests['LOAD_SEATS'].pending) && <Progress animated color=\"primary\" value={50} /> }\r\n      { (requests['LOAD_SEATS'] && requests['LOAD_SEATS'].error) && <Alert color=\"warning\">Couldn't load seats...</Alert> }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default SeatChooser;"],"mappings":"AAAA,OAASA,SAAS,KAAQ,OAAO,CACjC,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,MAAM,CAAEC,QAAQ,CAAEC,KAAK,KAAQ,YAAY,CACpD,OAASC,QAAQ,CAAEC,gBAAgB,CAAEC,WAAW,KAAQ,2BAA2B,CACnF,MAAO,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,KAAM,CAAAC,WAAW,CAAGC,IAAA,EAA2D,IAA1D,CAAEC,SAAS,CAAEC,UAAU,CAAEC,UAAU,CAAEC,cAAe,CAAC,CAAAJ,IAAA,CACxE,KAAM,CAAAK,QAAQ,CAAGlB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAmB,KAAK,CAAGlB,WAAW,CAACI,QAAQ,CAAC,CACnC,KAAM,CAAAe,QAAQ,CAAGnB,WAAW,CAACM,WAAW,CAAC,CAEzCR,SAAS,CAAC,IAAM,CACdmB,QAAQ,CAACZ,gBAAgB,CAAC,CAAC,CAAC,CAE5B,KAAM,CAAAe,QAAQ,CAAGC,WAAW,CAAC,IAAM,CACjCJ,QAAQ,CAACZ,gBAAgB,CAAC,CAAC,CAAC,CAC9B,CAAC,CAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAEb,MAAM,IAAMiB,aAAa,CAACF,QAAQ,CAAC,CACrC,CAAC,CAAE,CAACH,QAAQ,CAAC,CAAC,CAEdnB,SAAS,CAAC,IAAM,CACd,GAAIkB,cAAc,CAAE,CAClBC,QAAQ,CAACZ,gBAAgB,CAAC,CAAC,CAAC,CAC9B,CACF,CAAC,CAAE,CAACW,cAAc,CAAEC,QAAQ,CAAC,CAAC,CAE9B,KAAM,CAAAM,OAAO,CAAIC,MAAM,EAAK,CAC1B,MAAQ,CAAAN,KAAK,CAACO,IAAI,CAACC,IAAI,EAAKA,IAAI,CAACC,IAAI,GAAKH,MAAM,EAAIE,IAAI,CAACE,GAAG,GAAKf,SAAU,CAAC,CAC9E,CAAC,CAED,KAAM,CAAAgB,WAAW,CAAIL,MAAM,EAAK,CAC9B,GAAGA,MAAM,GAAKV,UAAU,CAAE,mBAAON,IAAA,CAACP,MAAM,EAAc6B,SAAS,CAAC,aAAa,CAACC,KAAK,CAAC,SAAS,CAAAC,QAAA,CAAER,MAAM,EAAvDA,MAAgE,CAAC,CAAC,IAC3G,IAAGD,OAAO,CAACC,MAAM,CAAC,CAAE,mBAAOhB,IAAA,CAACP,MAAM,EAAc6B,SAAS,CAAC,aAAa,CAACG,QAAQ,MAACF,KAAK,CAAC,WAAW,CAAAC,QAAA,CAAER,MAAM,EAAlEA,MAA2E,CAAC,CAAC,IACrH,oBAAOhB,IAAA,CAACP,MAAM,EAAc8B,KAAK,CAAC,SAAS,CAACD,SAAS,CAAC,aAAa,CAACI,OAAO,MAACC,OAAO,CAAGC,CAAC,EAAKrB,UAAU,CAACqB,CAAC,CAAEZ,MAAM,CAAE,CAAAQ,QAAA,CAAER,MAAM,EAAtGA,MAA+G,CAAC,CAC3I,CAAC,CAED,mBACEd,KAAA,QAAAsB,QAAA,eACExB,IAAA,OAAAwB,QAAA,CAAI,aAAW,CAAI,CAAC,cACpBtB,KAAA,QAAKoB,SAAS,CAAC,MAAM,CAAAE,QAAA,eACnBtB,KAAA,UAAO2B,EAAE,CAAC,UAAU,CAACP,SAAS,CAAC,2BAA2B,CAAAE,QAAA,eAACxB,IAAA,CAACP,MAAM,EAAC8B,KAAK,CAAC,WAAW,CAAE,CAAC,gCAAwB,EAAO,CAAC,cACvHrB,KAAA,UAAO2B,EAAE,CAAC,aAAa,CAACP,SAAS,CAAC,2BAA2B,CAAAE,QAAA,eAACxB,IAAA,CAACP,MAAM,EAACiC,OAAO,MAACH,KAAK,CAAC,SAAS,CAAE,CAAC,qBAAa,EAAO,CAAC,EAClH,CAAC,CACHZ,QAAQ,CAAC,YAAY,CAAC,EAAIA,QAAQ,CAAC,YAAY,CAAC,CAACmB,OAAO,eAAK9B,IAAA,QAAKsB,SAAS,CAAC,OAAO,CAAAE,QAAA,CAAE,CAAC,GAAGO,KAAK,CAAC,EAAE,CAAC,CAAC,CAACC,GAAG,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKb,WAAW,CAACa,CAAC,CAAC,CAAC,CAAE,CAAC,CAAM,CAAC,CAC3IvB,QAAQ,CAAC,YAAY,CAAC,EAAIA,QAAQ,CAAC,YAAY,CAAC,CAACwB,OAAO,eAAKnC,IAAA,CAACN,QAAQ,EAAC0C,QAAQ,MAACb,KAAK,CAAC,SAAS,CAACc,KAAK,CAAE,EAAG,CAAE,CAAC,CAC7G1B,QAAQ,CAAC,YAAY,CAAC,EAAIA,QAAQ,CAAC,YAAY,CAAC,CAAC2B,KAAK,eAAKtC,IAAA,CAACL,KAAK,EAAC4B,KAAK,CAAC,SAAS,CAAAC,QAAA,CAAC,wBAAsB,CAAO,CAAC,EAChH,CAAC,CAEV,CAAC,CAED,cAAe,CAAArB,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}